services:
  service:
    build:
      context: ../../.
      dockerfile: Dockerfile
      args:
        ARTIFACT: ./bin/svc
    ports:
      - ${SERVICE_APP_GRPC_PORT}:${SERVICE_APP_GRPC_PORT}
    environment:
      APP_LOG_LEVEL: ${SERVICE_APP_LOG_LEVEL}
      APP_DICTIONARY_STUB_ENABLED: ${SERVICE_APP_DICTIONARY_STUB_ENABLED}
      APP_GOOGLE_STUB_ENABLED: ${SERVICE_APP_GOOGLE_STUB_ENABLED}
      APP_OPENAI_STUB_ENABLED: ${SERVICE_APP_OPENAI_STUB_ENABLED}
      APP_GRPC_PORT: ${SERVICE_APP_GRPC_PORT}
      APP_MONGO_CARD_PROTOCOL: ${SERVICE_APP_MONGO_CARD_PROTOCOL}
      APP_MONGO_CARD_HOST: ${SERVICE_APP_MONGO_CARD_HOST}
      APP_MONGO_CARD_URI_PARAMS: ${SERVICE_APP_MONGO_CARD_URI_PARAMS}
      APP_MONGO_USER: ${MONGO_DB_USERNAME}
      APP_MONGO_PASS: ${MONGO_DB_PASSWORD}
      APP_MONGO_CARD_DATABASE: ${SERVICE_APP_MONGO_CARD_DATABASE}
      APP_MONGO_CARD_COLLECTION: ${SERVICE_APP_MONGO_CARD_COLLECTION}
      APP_USER_SESSION_EXPIRATION: ${SERVICE_APP_USER_SESSION_EXPIRATION}
      APP_USER_SESSION_KEY_PREFIX: ${SERVICE_APP_USER_SESSION_KEY_PREFIX}

  mongo:
    image: mongo:latest
    platform: linux/arm64
    restart: always
    ports:
      - ${MONGO_DB_PORT}:${MONGO_DB_PORT}
    environment:
      MONGO_INITDB_ROOT_USERNAME: ${MONGO_DB_USERNAME}
      MONGO_INITDB_ROOT_PASSWORD: ${MONGO_DB_PASSWORD}
